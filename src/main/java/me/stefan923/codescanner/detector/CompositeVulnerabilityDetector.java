package me.stefan923.codescanner.detector;

import com.github.javaparser.ast.Node;
import me.stefan923.codescanner.Vulnerability;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;

public class CompositeVulnerabilityDetector implements VulnerabilityDetector {
    private final List<VulnerabilityDetector> detectors = new ArrayList<>();

    public void addDetector(VulnerabilityDetector detector) {
        detectors.add(detector);
    }

    @Override
    public List<Vulnerability> detect(Node node, Map<String, Boolean> taintMap) {
        List<Vulnerability> results = new ArrayList<>();
        for (VulnerabilityDetector detector : detectors) {
            results.addAll(detector.detect(node, taintMap));
        }
        return results;
    }
}
